<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>完整案例</title>
    <style media="screen">
        body {
            background: #000;
        }
        #line {
          position: absolute;
          top: 0;
        }
        #circle {
          position: absolute;
          top: 0;
        }
    </style>
    <script src="../js/lodash.js"></script>
    <script src="../js/util.js"></script>
    <script src="canvasLine.js"></script>
    <script src="canvasCircle.js"></script>
</head>
<body>
    <canvas id="line"></canvas>
    <canvas id="circle"></canvas>
    <script>
        function initCanvas (container) {
          let canvas = document.getElementById(container);
          canvas.width = 900;
          canvas.height = 600;
          return canvas;
        }

        let colorMap = {
          1: [
            [0, 'rgba(255, 255, 255, 0)'],
            [0.9, 'rgba(247, 195, 59, 0.8)'],
            [1, 'rgba(247, 195, 59, 0.9)']
          ],
          2: [
            [0, 'rgba(255, 255, 255, 0)'],
            [0.9, 'rgba(226, 101, 48, 0.8)'],
            [1, 'rgba(226, 101, 48, 0.9)']
          ],
          3: [
            [0, 'rgba(255, 255, 255, 0)'],
            [0.9, 'rgba(205, 12, 14, 0.8)'],
            [1, 'rgba(205, 12, 14, 0.9)']
          ]
        }
        let circleColor = ['', 'rgba(247, 195, 59, ', 'rgba(226, 101, 48, ', 'rgba(205, 12, 14, ']
        let data = [
          {
            from: [100, 100],
            to: [800, 200],
            status: 1
          },
          {
            from: [100, 100],
            to: [100, 400],
            status: 2
          },
          {
            from: [100, 100],
            to: [400, 300],
            status: 3
          }
        ];

        let lineOpt = {
          canvas: initCanvas('line'),
          duration: 1500,
          delay: 0,
          repeatCount: Infinity, // Infinity
          width: 1,
          color: [
            [0, 'rgba(255, 255, 255, 0)'],
            [0.9, 'rgba(5, 255, 234, 0.8)'],
            [1, 'rgba(255, 255, 255, 0.9)']
          ]
        }
        let circleOpt = {
          canvas: initCanvas('circle')
        }
        let circlesData = []
        data.forEach((d, i) => {
          d.color = colorMap[d.status]
          circlesData.push({
            point: d.from,
            color: 'red',
            startTime: new Date().getTime()
          })
          circlesData.push({
            point: d.to,
            color: circleColor[d.status],
            startTime: new Date().getTime()
          })
        })
        let lines = new canvasLine(lineOpt)
        lines.setData(data)
        // let circles = new canvasCircle(circleOpt)
        // circles.setData(circlesData)
    </script>
</body>
</html>
